(this["webpackJsonpnile-portal"]=this["webpackJsonpnile-portal"]||[]).push([[27],{1121:function(e,t,a){"use strict";a.r(t);var n,c=a(706),r=a(896),o=a(784),i=a(40),s=a.n(i),j=a(116),l=a.n(j),u=a(50),b=a(779),d=a(0),p=a(801),O=a(758),m=a(2),f=function(){var e=Object(u.b)();return Object(m.jsxs)(p.f,{name:"IntegratedDates",children:[Object(m.jsx)(p.e,{name:"startViewDate",computed:function(t){var a=t.startViewDate;return e(Object(O.j)(a)),a}}),Object(m.jsx)(p.e,{name:"endViewDate",computed:function(t){var a=t.endViewDate;return e(Object(O.f)(a)),a}})]})},x=a(594),v=a(584),h=a(1116),g=a(1117),y=a(743),D=Object(v.a)((function(e){return{wrapper:{padding:e.spacing(2),paddingTop:0},section:{marginBottom:e.spacing(1)}}})),C=function(e){var t=e.appointmentData,a=D(),n=Object(y.g)(t),r=n.displayDate,o=n.displayTime;return Object(m.jsxs)(c.a,{className:a.wrapper,children:[Object(m.jsx)(x.a,{variant:"h3",color:"primary",className:a.section,children:s()(t,"title","")}),Object(m.jsx)("div",{className:a.section,children:Object(m.jsxs)(x.a,{variant:"h5",children:[Object(m.jsx)(h.a,{})," ",r]})}),Object(m.jsx)("div",{children:Object(m.jsxs)(x.a,{variant:"h5",children:[Object(m.jsx)(g.a,{})," ",o]})})]})},k=a(10),w=a(14),T=a(133),S=a(17),L=["children"],N=Object(v.a)((function(e){return{appointment:{backgroundColor:e.palette.primary.main,"&:hover":{backgroundColor:e.palette.primary.main}},busy:{backgroundColor:"#9e9e9e","&:hover":{backgroundColor:"#9e9e9e"}}}})),M=function(e){var t=e.children,a=Object(T.a)(e,L),n=a.data,c=N();return Object(m.jsx)(o.c.Appointment,Object(k.a)(Object(k.a)({},a),{},{className:Object(S.a)(c.appointment,Object(w.a)({},c.busy,Object(y.j)(n))),children:t}))},Y=Object(v.a)((function(e){return{disableCell:{background:"linear-gradient(-45deg,".concat(e.palette.action.disabledBackground," 10%,transparent 10%,transparent 50%,").concat(e.palette.action.disabledBackground," 50%,").concat(e.palette.action.disabledBackground," 60%,transparent 60%,transparent)"),backgroundSize:"8px 8px",pointerEvents:"none"}}})),A=function(e){var t=Y(),a=Object(u.c)((function(e){return s()(e,["calendar","config"])})),n=e.startDate;return Object(m.jsx)(o.h.TimeTableCell,Object(k.a)(Object(k.a)({},e),{},{className:Object(S.a)(Object(w.a)({},t.disableCell,!Object(y.k)({dateString:n,config:a})))}))},B=a(26),E=Object(v.a)((function(e){return{cell:{paddingTop:e.spacing(1)},today:{backgroundColor:Object(B.a)(e.palette.primary.main,.16)}}})),I=function(e){var t=E(),a=e.today;return Object(m.jsx)(o.h.DayScaleCell,Object(k.a)(Object(k.a)({},e),{},{className:Object(S.a)(t.cell,Object(w.a)({},t.today,a))}))},V=a(20),H=a(51),F=a.n(H),P=a(94),z=a(676),U=a(597),W=a(715),_=a(725),q=a(113),J=a(732),R=a.n(J),Z=(a(893),"SIMPLE"),K="CHECKBOX",X="MULTI_DROPDOWN",G="YYYY-MM-DDTHH:mm:ss",Q="MM/DD/YYYY",$=(n={},Object(w.a)(n,Z,""),Object(w.a)(n,K,!1),Object(w.a)(n,X,""),n),ee="daily",te="weekly",ae=function(e){var t=e.property,a=e.appointmentData,n=e.config.questions,c=a.startDate,r=R()(c).format(Q),o=s()(t,"PropertyData.FullAddress",""),i=s()(q.a,["user","attributes","email"],"");return Object(k.a)(Object(k.a)({},function(e){return e.reduce((function(e,t){var a=t.code,n=t.type;return Object(k.a)(Object(k.a)({},e),{},Object(w.a)({},a,$[n]))}),{appointmentType:void 0})}(n)),{},{FNAME:o,EMAIL:i,repeat:!1,repeatType:ee,startDate:r,endDate:r})},ne=function(e,t){return e.map((function(e){var a=e.code;return{code:a,string:t[a]}})).filter((function(e){return e.string}))},ce=function(e){var t=e.appointmentData,a=e.values,n=e.config,c=n.questions,r=t.startDate,o=a.repeat,i=a.repeatType,j=a.startDate,l=a.endDate,u=function(e){return e.find((function(e){return s()(e,"name","").toLowerCase()===b.b}))}(s()(n,"services.items",[]));if(!o)return[{title:b.b,startsAt:R()(r).format(G),tentative:"NOT_USED",timeZone:R.a.tz.guess(),cancelled:!1,units:1,services:[u],answers:ne(c,a)}];var d=R()(r).format("HH:mm:ss"),p=R()(j),O=R()(l).diff(p,"day"),m=i===te?7:1;return Array.from(Array(Math.floor(O/m)+1),(function(e,t){return t*m})).map((function(e){var t=R()(j).add(e,"day");return{title:b.b,startsAt:"".concat(t.format("YYYY-MM-DD"),"T").concat(d),tentative:"NOT_USED",timeZone:R.a.tz.guess(),cancelled:!1,units:1,services:[u],answers:ne(c,a)}}))},re=function(e){var t=e.map((function(e){return s()(e,"startsAt")})).join(", ");return{message:"Cannot book at dates: ".concat(t)}},oe=Object(v.a)((function(e){return{wrapper:Object(k.a)(Object(k.a)({},e.typography.h4),{},{padding:e.spacing(2,0),backgroundColor:e.palette.grey[100],textAlign:"center"})}})),ie=function(e){var t=e.appointmentData,a=t.startDate,n=t.endDate,c=oe(),r=Object(y.g)({startDate:a,endDate:n}),o=r.displayDate,i=r.displayTime;return Object(m.jsxs)("div",{className:c.wrapper,children:[Object(m.jsx)(x.a,{variant:"h4",children:o}),Object(m.jsx)(z.a,{sx:{mt:1},children:Object(m.jsx)(x.a,{variant:"h3",children:i})})]})},se=a(854),je=a(1070),le=a(1151),ue=a(1157),be=a(707),de=a(1135),pe=a(1125),Oe=a(701),me=a(756),fe=a(1118),xe=function(){var e=Object(_.e)(),t=e.values,a=e.handleChange,n=e.setFieldValue,c=function(e){return function(t){n(e,R()(t).format(Q))}},r=s()(t,"repeat"),o=s()(t,"repeatType"),i=s()(t,"startDate"),j=s()(t,"endDate");return Object(m.jsxs)("div",{children:[Object(m.jsx)(le.a,{control:Object(m.jsx)(ue.a,{name:"repeat",checked:r,onChange:a,color:"primary"}),label:"Repeat"}),Object(m.jsxs)(be.a,{in:r,children:[Object(m.jsx)("div",{children:Object(m.jsxs)(de.a,{name:"repeatType",value:o,onChange:a,children:[Object(m.jsx)(le.a,{value:"daily",control:Object(m.jsx)(pe.a,{color:"primary"}),label:"Daily"}),Object(m.jsx)(le.a,{value:"weekly",control:Object(m.jsx)(pe.a,{color:"primary"}),label:"Weekly"})]})}),Object(m.jsx)(Oe.a,{container:!0,justifyContent:"space-between",children:Object(m.jsxs)(me.a,{utils:je.a,children:[Object(m.jsx)(fe.a,{disableToolbar:!0,inputVariant:"outlined",format:Q,margin:"normal",label:"Start date",value:new Date(i),onChange:c("startDate")}),Object(m.jsx)(fe.a,{disableToolbar:!0,inputVariant:"outlined",format:Q,margin:"normal",label:"End date",value:new Date(j),onChange:c("endDate")})]})})]})]})},ve=function(e){var t=e.appointmentData,a=e.onSave,n=Object(u.b)(),c=Object(u.c)((function(e){return s()(e,["calendar","property"])})),r=s()(c,"CalendarProfileId"),o=Object(u.c)((function(e){return s()(e,["calendar","config"])})),i=Object(u.c)((function(e){return s()(e,["calendar","isLoading"])})),j=ae({property:c,appointmentData:t,config:o}),b=function(){var e=Object(P.a)(F.a.mark((function e(c){var i,s,j,u;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(Object(O.h)(!0)),e.prev=1,i=ce({appointmentData:t,values:c,config:o}),e.next=5,se.a.createBookings({profileId:r,data:i});case 5:s=e.sent,j=s.bookings,u=s.errors,l()(u)||n(Object(O.g)(re(u))),n(Object(O.a)(j)),a(),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),n(Object(O.g)(e.t0));case 16:n(Object(O.h)(!1));case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsx)(z.a,{sx:{display:"flex",flexDirection:"column"},children:Object(m.jsx)(_.c,{initialValues:j,onSubmit:b,children:Object(m.jsxs)(_.b,{children:[Object(m.jsx)(z.a,{sx:{mb:2},children:Object(m.jsx)(x.a,{variant:"h4",children:"Block available slots"})}),Object(m.jsx)(ie,{appointmentData:t}),Object(m.jsx)(U.a,{}),Object(m.jsx)(z.a,{sx:{my:2},children:Object(m.jsx)(xe,{})}),Object(m.jsx)(W.a,{type:"submit",color:"primary",disableElevation:!0,fullWidth:!0,variant:"contained",disabled:i,children:"Confirm Booking"})]})})})},he=function(e){var t=e.appointmentData,a=e.onSave;return Object(m.jsx)(ve,{appointmentData:t,onSave:a})},ge=["basicLayoutComponent","commandLayoutComponent","recurrenceLayoutComponent","children"],ye=Object(v.a)((function(e){return{layout:{background:e.palette.common.white},content:{padding:e.spacing(4)}}})),De=function(e){var t=e.basicLayoutComponent,a=e.commandLayoutComponent,n=e.recurrenceLayoutComponent,c=e.children,r=Object(T.a)(e,ge),o=ye();return Object(m.jsxs)("div",Object(k.a)(Object(k.a)({className:o.layout},r),{},{children:[Object(m.jsx)(a,{}),Object(m.jsxs)("div",{className:o.content,children:[Object(m.jsx)(t,{}),Object(m.jsx)(n,{})]}),c]}))},Ce=function(e){var t=e.onCommitButtonClick,a=e.isSaving,n=e.setIsSaving;return Object(d.useEffect)((function(){a&&(t(),n(!1))}),[a]),Object(m.jsx)("div",{})},ke=function(){var e=Object(d.useState)(!1),t=Object(V.a)(e,2),a=t[0],n=t[1],c=Object(p.k)(he,(function(){return{onSave:function(){return n(!0)}}})),r=Object(p.k)(Ce,(function(){return{isSaving:a,setIsSaving:n}}));return Object(m.jsx)(o.a,{layoutComponent:De,basicLayoutComponent:c,commandLayoutComponent:r})};t.default=function(e){if(!e.profileId)return null;var t=Object(u.c)((function(e){return s()(e,["calendar","config"])})),a=Object(u.c)((function(e){return s()(e,["calendar","appointments"])}));return l()(t)?Object(m.jsx)(m.Fragment,{}):Object(m.jsx)(c.a,{elevation:3,children:Object(m.jsxs)(o.e,{data:a,children:[Object(m.jsx)(r.r,{}),Object(m.jsx)(o.h,{timeTableCellComponent:A,dayScaleCellComponent:I,cellDuration:s()(t,"slotLengthMinutes")||b.c}),Object(m.jsx)(r.k,{onCommitChanges:function(){}}),Object(m.jsx)(f,{}),Object(m.jsx)(o.g,{}),Object(m.jsx)(o.d,{}),Object(m.jsx)(o.f,{}),Object(m.jsx)(o.c,{appointmentComponent:M}),Object(m.jsx)(o.b,{showCloseButton:!0,contentComponent:C}),Object(m.jsx)(ke,{})]})})}}}]);
//# sourceMappingURL=27.8e6be9e8.chunk.js.map