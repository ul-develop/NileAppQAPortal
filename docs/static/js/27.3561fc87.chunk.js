(this["webpackJsonpnile-portal"]=this["webpackJsonpnile-portal"]||[]).push([[27],{1113:function(e,t,a){"use strict";a.r(t);var n,c=a(707),r=a(882),i=a(778),o=a(40),s=a.n(o),j=a(116),l=a.n(j),b=a(50),u=a(777),d=a(0),p=a(794),O=a(757),m=a(2),f=function(){var e=Object(b.b)();return Object(m.jsxs)(p.f,{name:"IntegratedDates",children:[Object(m.jsx)(p.e,{name:"startViewDate",computed:function(t){var a=t.startViewDate;return e(Object(O.j)(a)),a}}),Object(m.jsx)(p.e,{name:"endViewDate",computed:function(t){var a=t.endViewDate;return e(Object(O.f)(a)),a}})]})},x=a(594),h=a(584),v=a(1107),g=a(1108),y=a(744),D=Object(h.a)((function(e){return{wrapper:{padding:e.spacing(2),paddingTop:0},section:{marginBottom:e.spacing(1)}}})),C=function(e){var t=e.appointmentData,a=D(),n=Object(y.g)(t),r=n.displayDate,i=n.displayTime;return Object(m.jsxs)(c.a,{className:a.wrapper,children:[Object(m.jsx)(x.a,{variant:"h3",color:"primary",className:a.section,children:s()(t,"title","")}),Object(m.jsx)("div",{className:a.section,children:Object(m.jsxs)(x.a,{variant:"h5",children:[Object(m.jsx)(v.a,{})," ",r]})}),Object(m.jsx)("div",{children:Object(m.jsxs)(x.a,{variant:"h5",children:[Object(m.jsx)(g.a,{})," ",i]})})]})},k=a(10),w=a(14),T=a(133),S=a(17),L=["children"],N=Object(h.a)((function(e){return{appointment:{backgroundColor:e.palette.primary.main,"&:hover":{backgroundColor:e.palette.primary.main}},busy:{backgroundColor:"#9e9e9e","&:hover":{backgroundColor:"#9e9e9e"}}}})),M=function(e){var t=e.children,a=Object(T.a)(e,L),n=a.data,c=N();return Object(m.jsx)(i.c.Appointment,Object(k.a)(Object(k.a)({},a),{},{className:Object(S.a)(c.appointment,Object(w.a)({},c.busy,Object(y.j)(n))),children:t}))},Y=Object(h.a)((function(e){return{disableCell:{background:"linear-gradient(-45deg,".concat(e.palette.action.disabledBackground," 10%,transparent 10%,transparent 50%,").concat(e.palette.action.disabledBackground," 50%,").concat(e.palette.action.disabledBackground," 60%,transparent 60%,transparent)"),backgroundSize:"8px 8px",pointerEvents:"none"}}})),A=function(e){var t=Y(),a=Object(b.c)((function(e){return s()(e,["calendar","config"])})),n=e.startDate;return Object(m.jsx)(i.h.TimeTableCell,Object(k.a)(Object(k.a)({},e),{},{className:Object(S.a)(Object(w.a)({},t.disableCell,!Object(y.k)({dateString:n,config:a})))}))},I=a(26),B=Object(h.a)((function(e){return{cell:{paddingTop:e.spacing(1)},today:{backgroundColor:Object(I.a)(e.palette.primary.main,.16)}}})),E=function(e){var t=B(),a=e.today;return Object(m.jsx)(i.h.DayScaleCell,Object(k.a)(Object(k.a)({},e),{},{className:Object(S.a)(t.cell,Object(w.a)({},t.today,a))}))},V=a(20),F=a(51),H=a.n(F),P=a(94),z=a(676),U=a(597),W=a(716),_=a(727),q=a(113),J=a(733),R=a.n(J),Z=(a(879),"SIMPLE"),K="CHECKBOX",X="MULTI_DROPDOWN",G="YYYY-MM-DDTHH:mm:ss",Q="MM/DD/YYYY",$=(n={},Object(w.a)(n,Z,""),Object(w.a)(n,K,!1),Object(w.a)(n,X,""),n),ee="daily",te="weekly",ae=function(e){var t=e.property,a=e.appointmentData,n=e.config.questions,c=a.startDate,r=R()(c).format(Q),i=s()(t,"PropertyData.FullAddress",""),o=s()(q.a,["user","attributes","email"],"");return Object(k.a)(Object(k.a)({},function(e){return e.reduce((function(e,t){var a=t.code,n=t.type;return Object(k.a)(Object(k.a)({},e),{},Object(w.a)({},a,$[n]))}),{appointmentType:void 0})}(n)),{},{FNAME:i,EMAIL:o,repeat:!1,repeatType:ee,startDate:r,endDate:r})},ne=function(e,t){return e.map((function(e){var a=e.code;return{code:a,string:t[a]}})).filter((function(e){return e.string}))},ce=function(e){var t=e.appointmentData,a=e.values,n=e.config,c=n.questions,r=t.startDate,i=a.repeat,o=a.repeatType,j=a.startDate,l=a.endDate,b=function(e){return e.find((function(e){return s()(e,"name","").toLowerCase()===u.b}))}(s()(n,"services.items",[]));if(!i)return[{title:u.b,startsAt:R()(r).format(G),tentative:"NOT_USED",timeZone:R.a.tz.guess(),cancelled:!1,units:1,services:[b],answers:ne(c,a)}];var d=R()(r).format("HH:mm:ss"),p=R()(j),O=R()(l).diff(p,"day"),m=o===te?7:1;return Array.from(Array(Math.floor(O/m)+1),(function(e,t){return t*m})).map((function(e){var t=R()(j).add(e,"day");return{title:u.b,startsAt:"".concat(t.format("YYYY-MM-DD"),"T").concat(d),tentative:"NOT_USED",timeZone:R.a.tz.guess(),cancelled:!1,units:1,services:[b],answers:ne(c,a)}}))},re=function(e){var t=e.map((function(e){return s()(e,"startsAt")})).join(", ");return{message:"Cannot book at dates: ".concat(t)}},ie=Object(h.a)((function(e){return{wrapper:Object(k.a)(Object(k.a)({},e.typography.h4),{},{padding:e.spacing(2,0),backgroundColor:e.palette.grey[100],textAlign:"center"})}})),oe=function(e){var t=e.appointmentData,a=t.startDate,n=t.endDate,c=ie(),r=Object(y.g)({startDate:a,endDate:n}),i=r.displayDate,o=r.displayTime;return Object(m.jsxs)("div",{className:c.wrapper,children:[Object(m.jsx)(x.a,{variant:"h4",children:i}),Object(m.jsx)(z.a,{sx:{mt:1},children:Object(m.jsx)(x.a,{variant:"h3",children:o})})]})},se=a(839),je=a(1056),le=a(1143),be=a(1148),ue=a(708),de=a(1127),pe=a(1117),Oe=a(702),me=a(1135),fe=a(1109),xe=a(1111),he=["helperText"],ve=["helperText"],ge=function(){var e=Object(_.e)(),t=e.values,a=e.handleChange,n=e.setFieldValue,c=function(e){return function(t){n(e,R()(t).format(Q))}},r=s()(t,"repeat"),i=s()(t,"repeatType"),o=s()(t,"startDate"),j=s()(t,"endDate");return Object(m.jsxs)("div",{children:[Object(m.jsx)(le.a,{control:Object(m.jsx)(be.a,{name:"repeat",checked:r,onChange:a,color:"primary"}),label:"Repeat"}),Object(m.jsxs)(ue.a,{in:r,children:[Object(m.jsx)("div",{children:Object(m.jsxs)(de.a,{name:"repeatType",value:i,onChange:a,children:[Object(m.jsx)(le.a,{value:"daily",control:Object(m.jsx)(pe.a,{color:"primary"}),label:"Daily"}),Object(m.jsx)(le.a,{value:"weekly",control:Object(m.jsx)(pe.a,{color:"primary"}),label:"Weekly"})]})}),Object(m.jsx)(z.a,{sx:{mt:2,mb:1},children:Object(m.jsx)(fe.b,{dateAdapter:je.a,children:Object(m.jsxs)(Oe.a,{container:!0,justifyContent:"space-between",children:[Object(m.jsx)(Oe.a,{item:!0,xs:5,children:Object(m.jsx)(xe.a,{label:"Start date",inputFormat:Q,value:new Date(o),onChange:c("startDate"),renderInput:function(e){e.helperText;var t=Object(T.a)(e,he);return Object(m.jsx)(me.a,Object(k.a)({},t))}})}),Object(m.jsx)(Oe.a,{item:!0,xs:5,children:Object(m.jsx)(xe.a,{label:"End date",inputFormat:Q,value:new Date(j),onChange:c("endDate"),renderInput:function(e){e.helperText;var t=Object(T.a)(e,ve);return Object(m.jsx)(me.a,Object(k.a)({},t))}})})]})})})]})]})},ye=function(e){var t=e.appointmentData,a=e.onSave,n=Object(b.b)(),c=Object(b.c)((function(e){return s()(e,["calendar","property"])})),r=s()(c,"HomeViewingCalendarProfileId"),i=Object(b.c)((function(e){return s()(e,["calendar","config"])})),o=Object(b.c)((function(e){return s()(e,["calendar","isLoading"])})),j=ae({property:c,appointmentData:t,config:i}),u=function(){var e=Object(P.a)(H.a.mark((function e(c){var o,s,j,b;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(Object(O.h)(!0)),e.prev=1,o=ce({appointmentData:t,values:c,config:i}),e.next=5,se.a.createBookings({profileId:r,data:o});case 5:s=e.sent,j=s.bookings,b=s.errors,l()(b)||n(Object(O.g)(re(b))),n(Object(O.a)(j)),a(),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),n(Object(O.g)(e.t0));case 16:n(Object(O.h)(!1));case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsx)(z.a,{sx:{display:"flex",flexDirection:"column"},children:Object(m.jsx)(_.c,{initialValues:j,onSubmit:u,children:Object(m.jsxs)(_.b,{children:[Object(m.jsx)(z.a,{sx:{mb:2},children:Object(m.jsx)(x.a,{variant:"h4",children:"Block available slots"})}),Object(m.jsx)(oe,{appointmentData:t}),Object(m.jsx)(U.a,{}),Object(m.jsx)(z.a,{sx:{my:2},children:Object(m.jsx)(ge,{})}),Object(m.jsx)(W.a,{type:"submit",color:"primary",disableElevation:!0,fullWidth:!0,variant:"contained",disabled:o,children:"Confirm Booking"})]})})})},De=function(e){var t=e.appointmentData,a=e.onSave;return Object(m.jsx)(ye,{appointmentData:t,onSave:a})},Ce=["basicLayoutComponent","commandLayoutComponent","recurrenceLayoutComponent","children"],ke=Object(h.a)((function(e){return{layout:{background:e.palette.common.white},content:{padding:e.spacing(4)}}})),we=function(e){var t=e.basicLayoutComponent,a=e.commandLayoutComponent,n=e.recurrenceLayoutComponent,c=e.children,r=Object(T.a)(e,Ce),i=ke();return Object(m.jsxs)("div",Object(k.a)(Object(k.a)({className:i.layout},r),{},{children:[Object(m.jsx)(a,{}),Object(m.jsxs)("div",{className:i.content,children:[Object(m.jsx)(t,{}),Object(m.jsx)(n,{})]}),c]}))},Te=function(e){var t=e.onCommitButtonClick,a=e.isSaving,n=e.setIsSaving;return Object(d.useEffect)((function(){a&&(t(),n(!1))}),[a]),Object(m.jsx)("div",{})},Se=function(){var e=Object(d.useState)(!1),t=Object(V.a)(e,2),a=t[0],n=t[1],c=Object(p.k)(De,(function(){return{onSave:function(){return n(!0)}}})),r=Object(p.k)(Te,(function(){return{isSaving:a,setIsSaving:n}}));return Object(m.jsx)(i.a,{layoutComponent:we,basicLayoutComponent:c,commandLayoutComponent:r})};t.default=function(e){if(!e.profileId)return null;var t=Object(b.c)((function(e){return s()(e,["calendar","config"])})),a=Object(b.c)((function(e){return s()(e,["calendar","appointments"])}));return l()(t)?Object(m.jsx)(m.Fragment,{}):Object(m.jsx)(c.a,{elevation:3,children:Object(m.jsxs)(i.e,{data:a,children:[Object(m.jsx)(r.r,{}),Object(m.jsx)(i.h,{timeTableCellComponent:A,dayScaleCellComponent:E,cellDuration:s()(t,"slotLengthMinutes")||u.c}),Object(m.jsx)(r.k,{onCommitChanges:function(){}}),Object(m.jsx)(f,{}),Object(m.jsx)(i.g,{}),Object(m.jsx)(i.d,{}),Object(m.jsx)(i.f,{}),Object(m.jsx)(i.c,{appointmentComponent:M}),Object(m.jsx)(i.b,{showCloseButton:!0,contentComponent:C}),Object(m.jsx)(Se,{})]})})}}}]);
//# sourceMappingURL=27.3561fc87.chunk.js.map