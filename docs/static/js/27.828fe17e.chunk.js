(this["webpackJsonpnile-portal"]=this["webpackJsonpnile-portal"]||[]).push([[27],{1114:function(e,t,n){"use strict";n.r(t);var a,c=n(713),r=n(885),i=n(781),o=n(28),s=n.n(o),l=n(117),j=n.n(l),u=n(51),b=n(164),d=n(0),O=n(797),p=n(744),m=n(2),f=function(){var e=Object(u.c)();return Object(m.jsxs)(O.f,{name:"IntegratedDates",children:[Object(m.jsx)(O.e,{name:"startViewDate",computed:function(t){var n=t.startViewDate;return e(Object(p.l)(n)),n}}),Object(m.jsx)(O.e,{name:"endViewDate",computed:function(t){var n=t.endViewDate;return e(Object(p.h)(n)),n}})]})},x=n(600),v=n(590),h=n(1108),g=n(1109),y=n(303),C=Object(v.a)((function(e){return{wrapper:{padding:e.spacing(2),paddingTop:0},section:{marginBottom:e.spacing(1)}}})),D=function(e){var t=e.appointmentData,n=C(),a=Object(y.n)(t),r=a.displayDate,i=a.displayTime;return Object(m.jsxs)(c.a,{className:n.wrapper,children:[Object(m.jsx)(x.a,{variant:"h3",color:"primary",className:n.section,children:s()(t,"title","")}),Object(m.jsx)("div",{className:n.section,children:Object(m.jsxs)(x.a,{variant:"h5",children:[Object(m.jsx)(h.a,{})," ",r]})}),Object(m.jsx)("div",{children:Object(m.jsxs)(x.a,{variant:"h5",children:[Object(m.jsx)(g.a,{})," ",i]})})]})},k=n(9),w=n(14),L=n(134),M=n(17),S=["children"],I=Object(v.a)((function(e){return{appointment:{zIndex:e.zIndex.speedDial,backgroundColor:e.palette.primary.main,"&:hover":{backgroundColor:e.palette.primary.main}},busy:{backgroundColor:"#9e9e9e","&:hover":{backgroundColor:"#9e9e9e"}}}})),T=function(e){var t=e.children,n=Object(L.a)(e,S),a=n.data,c=I();return Object(m.jsx)(i.c.Appointment,Object(k.a)(Object(k.a)({},n),{},{className:Object(M.a)(c.appointment,Object(w.a)({},c.busy,Object(y.s)(a))),children:t}))},A=["startDate","onDoubleClick"],E=Object(v.a)((function(e){return{cell:{zIndex:e.zIndex.mobileStepper},disableCell:{background:"linear-gradient(-45deg,".concat(e.palette.action.disabledBackground," 10%,transparent 10%,transparent 50%,").concat(e.palette.action.disabledBackground," 50%,").concat(e.palette.action.disabledBackground," 60%,transparent 60%,transparent)"),backgroundSize:"8px 8px",pointerEvents:"none"}}})),N=function(e){var t=E(),n=Object(u.d)((function(e){return s()(e,["calendar","config"])})),a=e.startDate,c=e.onDoubleClick,r=Object(L.a)(e,A),o=Object(u.c)();return Object(m.jsx)(i.h.TimeTableCell,Object(k.a)(Object(k.a)({},r),{},{startDate:a,id:(null===a||void 0===a?void 0:a.toString())||"",onMouseDown:function(e){e.preventDefault(),o(Object(p.c)(a))},onMouseEnter:function(e){e.preventDefault(),o(Object(p.b)(a))},onMouseUp:function(e){e.preventDefault(),c&&c(e)},className:Object(M.a)(t.cell,Object(w.a)({},t.disableCell,!Object(y.t)({dateString:a,config:n})),y.a)}))},B=Object(d.memo)(N),Y=n(26),z=n(682),H=n(840),P=n(48),V=n.n(P),F=Object(v.a)((function(e){return{cells:{width:"100%",position:"absolute",left:0,background:e.palette.primary.light}}})),U=function(e){var t=F(),n=e.selectingCells,a=e.slotLengthMinutes,c=Object(y.o)(n,a),r=function(e){if(e.preventDefault(),!j()(n)){var t=e.target;if(!t.classList.contains(y.a)&&!Object(y.u)(y.d,t)&&!Object(y.u)(y.c,t)){var a=n.startCell,c=document.getElementById(a.toString());c&&c.dispatchEvent(new Event("mouseup",{bubbles:!0}))}}};return d.useEffect((function(){return window.addEventListener("mouseup",r),function(){window.removeEventListener("mouseup",r)}}),[]),Object(m.jsx)("div",{className:t.cells,style:c})},W=Object(H.a)({selectingCells:function(e){return s()(e,"calendar.selectingCells")},slotLengthMinutes:function(e){return s()(e,"calendar.config.times.slotLengthMinutes")}}),_=Object(u.b)(W)(d.memo(U)),q=Object(v.a)((function(e){return{cell:{"&&":{padding:e.spacing(1,0),width:"100%",display:"block",textAlign:"center"}},today:{backgroundColor:Object(Y.a)(e.palette.primary.main,.16)}}})),J=function(e){var t=q(),n=e.today,a=e.startDate,c=e.selectingDate,r=e.isSelecting&&c===V()(a).format(y.b);return Object(m.jsxs)(z.a,{component:"td",sx:{display:"table-cell",position:"relative",width:"100%"},children:[Object(m.jsx)(i.h.DayScaleCell,Object(k.a)(Object(k.a)({},e),{},{className:Object(M.a)(t.cell,Object(w.a)({},t.today,n))})),r&&Object(m.jsx)(_,{})]})},R=Object(H.a)({selectingDate:function(e){return s()(e,"calendar.selectingCells.date")},isSelecting:function(e){return s()(e,"calendar.isSelecting")}}),Z=Object(u.b)(R)(d.memo(J)),K=n(20),X=n(52),G=n.n(X),Q=n(95),$=n(603),ee=n(722),te=n(733),ne=n(27),ae=n(115),ce=(n(415),"SIMPLE"),re="CHECKBOX",ie="MULTI_DROPDOWN",oe="MM/DD/YYYY",se=(a={},Object(w.a)(a,ce,""),Object(w.a)(a,re,!1),Object(w.a)(a,ie,""),a),le="daily",je="weekly",ue=function(e){var t=e.property,n=e.selectingCells,a=e.config,c=a.questions,r=a.times.slotLengthMinutes,i=Object(y.m)(n,r).start.format(oe),o=s()(t,"PropertyData.FullAddress",""),l=s()(ae.a,["user","attributes","email"],"");return Object(k.a)(Object(k.a)({},function(e){return e.reduce((function(e,t){var n=t.code,a=t.type;return Object(k.a)(Object(k.a)({},e),{},Object(w.a)({},n,se[a]))}),{appointmentType:void 0})}(c)),{},{FNAME:o,EMAIL:l,repeat:!1,repeatType:le,startDate:i,endDate:i})},be=function(e,t){return e.map((function(e){var n=e.code;return{code:n,string:t[n]}})).filter((function(e){return e.string}))},de=function(e){var t=e.selectingCells,n=e.values,a=e.config,c=a.questions,r=a.times.slotLengthMinutes,i=n.repeat,o=n.repeatType,l=n.startDate,j=n.endDate,u=function(e){return e.find((function(e){return s()(e,"name","").toLowerCase()===b.b}))}(s()(a,"services.items",[])),d=function(e,t){var n=e.startCell,a=e.endCell,c=Object(y.m)(e,t).start,r=Object(y.v)(n),i=Object(y.v)(a),o=Math.abs((r-i)/t)+1;return Array.from(Array(o),(function(e,n){return{startsAt:V()(c).add(n*t,"m").format("YYYY-MM-DDTHH:mm:ss")}}))}(t,r);if(!i)return d.map((function(e){return{startsAt:e.startsAt,title:b.b,tentative:"NOT_USED",timeZone:V.a.tz.guess(),cancelled:!1,units:1,services:[u],answers:be(c,n)}}));var O=V()(l),p=V()(j).diff(O,"day"),m=o===je?7:1;return Array.from(Array(Math.floor(p/m)+1),(function(e,t){return t*m})).reduce((function(e,t){var a=V()(l).add(t,"day"),r=d.map((function(e){var t=e.startsAt;return{title:b.b,startsAt:"".concat(a.format("YYYY-MM-DD"),"T").concat(V()(t).format("HH:mm:ss")),tentative:"NOT_USED",timeZone:V.a.tz.guess(),cancelled:!1,units:1,services:[u],answers:be(c,n)}}));return[].concat(Object(ne.a)(e),Object(ne.a)(r))}),[])},Oe=function(e){var t=e.map((function(e){return s()(e,"startsAt")})).join(", ");return{message:"Cannot book at dates: ".concat(t)}},pe=Object(v.a)((function(e){return{wrapper:Object(k.a)(Object(k.a)({},e.typography.h4),{},{padding:e.spacing(2,0),backgroundColor:e.palette.grey[100],textAlign:"center"})}})),me=function(e){var t=e.selectingCells,n=e.slotLengthMinutes,a=pe();if(j()(t))return Object(m.jsx)("div",{});var c=t.date,r=Object(y.m)(t,n),i=r.start,o=r.end,s=Object(y.l)(i),l=Object(y.l)(o);return Object(m.jsxs)("div",{className:a.wrapper,children:[Object(m.jsx)(x.a,{variant:"h4",children:Object(y.j)(c)}),Object(m.jsx)(z.a,{sx:{mt:1},children:Object(m.jsxs)(x.a,{variant:"h3",children:[s," - ",l]})})]})},fe=Object(H.a)({selectingCells:function(e){return s()(e,"calendar.selectingCells")},slotLengthMinutes:function(e){return s()(e,"calendar.config.times.slotLengthMinutes")}}),xe=Object(u.b)(fe)(Object(d.memo)(me)),ve=n(843),he=n(1057),ge=n(1144),ye=n(1149),Ce=n(714),De=n(1128),ke=n(1118),we=n(708),Le=n(1136),Me=n(1110),Se=n(1112),Ie=["helperText"],Te=["helperText"],Ae=function(){var e=Object(te.e)(),t=e.values,n=e.handleChange,a=e.setFieldValue,c=function(e){return function(t){a(e,V()(t).format(oe))}},r=s()(t,"repeat"),i=s()(t,"repeatType"),o=s()(t,"startDate"),l=s()(t,"endDate");return Object(m.jsxs)("div",{children:[Object(m.jsx)(ge.a,{control:Object(m.jsx)(ye.a,{name:"repeat",checked:r,onChange:n,color:"primary"}),label:"Repeat"}),Object(m.jsxs)(Ce.a,{in:r,children:[Object(m.jsx)("div",{children:Object(m.jsxs)(De.a,{name:"repeatType",value:i,onChange:n,children:[Object(m.jsx)(ge.a,{value:"daily",control:Object(m.jsx)(ke.a,{color:"primary"}),label:"Daily"}),Object(m.jsx)(ge.a,{value:"weekly",control:Object(m.jsx)(ke.a,{color:"primary"}),label:"Weekly"})]})}),Object(m.jsx)(z.a,{sx:{mt:2,mb:1},children:Object(m.jsx)(Me.b,{dateAdapter:he.a,children:Object(m.jsxs)(we.a,{container:!0,justifyContent:"space-between",children:[Object(m.jsx)(we.a,{item:!0,xs:5,children:Object(m.jsx)(Se.a,{label:"Start date",inputFormat:oe,value:new Date(o),onChange:c("startDate"),renderInput:function(e){e.helperText;var t=Object(L.a)(e,Ie);return Object(m.jsx)(Le.a,Object(k.a)({},t))},PopperProps:{id:y.c}})}),Object(m.jsx)(we.a,{item:!0,xs:5,children:Object(m.jsx)(Se.a,{label:"End date",inputFormat:oe,value:new Date(l),onChange:c("endDate"),renderInput:function(e){e.helperText;var t=Object(L.a)(e,Te);return Object(m.jsx)(Le.a,Object(k.a)({},t))},PopperProps:{id:y.c}})})]})})})]})]})},Ee=function(e){var t=e.onSave,n=Object(u.c)(),a=Object(u.d)((function(e){return s()(e,["calendar","property"])})),c=s()(a,"HomeViewingCalendarProfileId"),r=Object(u.d)((function(e){return s()(e,["calendar","config"])})),i=Object(u.d)((function(e){return s()(e,["calendar","isLoading"])})),o=Object(u.d)((function(e){return s()(e,["calendar","selectingCells"])}));if(j()(o))return Object(m.jsx)(z.a,{});var l=ue({property:a,selectingCells:o,config:r}),b=function(){var e=Object(Q.a)(G.a.mark((function e(a){var i,s,l,u;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(Object(p.j)(!0)),e.prev=1,i=de({selectingCells:o,values:a,config:r}),e.next=5,ve.a.createBookings({profileId:c,data:i});case 5:s=e.sent,l=s.bookings,u=s.errors,j()(u)||n(Object(p.i)(Oe(u))),n(Object(p.a)(l)),t(),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),n(Object(p.i)(e.t0));case 16:n(Object(p.j)(!1));case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsx)(z.a,{sx:{display:"flex",flexDirection:"column"},children:Object(m.jsx)(te.c,{initialValues:l,onSubmit:b,children:Object(m.jsxs)(te.b,{children:[Object(m.jsx)(z.a,{sx:{mb:2},children:Object(m.jsx)(x.a,{variant:"h4",children:"Block available slots"})}),Object(m.jsx)(xe,{}),Object(m.jsx)($.a,{}),Object(m.jsx)(z.a,{sx:{my:2},children:Object(m.jsx)(Ae,{})}),Object(m.jsx)(ee.a,{type:"submit",color:"primary",disableElevation:!0,fullWidth:!0,variant:"contained",disabled:i,children:"Confirm Booking"})]})})})},Ne=function(e){var t=e.onSave;return Object(m.jsx)(Ee,{onSave:t})},Be=n(706),Ye=n(711),ze=n(684),He=["children","visible","onHide"],Pe=Object(v.a)((function(e){return{root:{display:"flex",alignItems:"center",justifyContent:"center"},content:{zIndex:e.zIndex.appBar}}})),Ve=function(e){var t=e.children,n=e.visible,a=e.onHide,c=Object(L.a)(e,He),r=Pe(),i=Object(u.c)();return Object(m.jsx)(Be.a,Object(k.a)(Object(k.a)({id:y.d,className:r.root,onClose:function(){a(),i(Object(p.m)())},closeAfterTransition:!0,BackdropComponent:Ye.a,BackdropProps:{timeout:500},open:n},c),{},{children:Object(m.jsx)(ze.a,{in:n,children:Object(m.jsx)("div",{className:r.content,children:t})})}))},Fe=["basicLayoutComponent","commandLayoutComponent","recurrenceLayoutComponent","children"],Ue=Object(v.a)((function(e){return{layout:{background:e.palette.common.white},content:{padding:e.spacing(4),width:"30vw",minWidth:"300px",overflow:"auto",maxHeight:"90vh"}}})),We=function(e){var t=e.basicLayoutComponent,n=e.commandLayoutComponent,a=e.recurrenceLayoutComponent,c=e.children,r=Object(L.a)(e,Fe),i=Ue();return Object(m.jsxs)("div",Object(k.a)(Object(k.a)({className:i.layout},r),{},{children:[Object(m.jsx)(n,{}),Object(m.jsxs)("div",{className:i.content,children:[Object(m.jsx)(t,{}),Object(m.jsx)(a,{})]}),c]}))},_e=function(e){var t=e.onCommitButtonClick,n=e.isSaving,a=e.setIsSaving;return Object(d.useEffect)((function(){n&&(t(),a(!1))}),[n]),Object(m.jsx)("div",{})},qe=function(){var e=Object(d.useState)(!1),t=Object(K.a)(e,2),n=t[0],a=t[1],c=Object(u.c)(),r=function(){a(!0),c(Object(p.m)())},o=Object(O.k)(Ne,(function(){return{onSave:r}})),s=Object(O.k)(_e,(function(){return{isSaving:n,setIsSaving:a}}));return Object(m.jsx)(i.a,{layoutComponent:We,basicLayoutComponent:o,commandLayoutComponent:s,overlayComponent:Ve})},Je=["style","children"],Re=function(e){var t=e.style,n=e.children,a=Object(L.a)(e,Je);return Object(m.jsx)("div",Object(k.a)(Object(k.a)({style:Object(k.a)(Object(k.a)({},t),{},{zIndex:1200})},a),{},{children:n}))};t.default=function(e){if(!e.profileId)return null;var t=Object(u.d)((function(e){return s()(e,["calendar","config"])})),n=Object(u.d)((function(e){return s()(e,["calendar","appointments"])}));return j()(t)?Object(m.jsx)(m.Fragment,{}):Object(m.jsx)(c.a,{elevation:3,children:Object(m.jsxs)(i.e,{data:n,children:[Object(m.jsx)(r.r,{}),Object(m.jsx)(i.h,{timeTableCellComponent:B,dayScaleCellComponent:Z,cellDuration:s()(t,"slotLengthMinutes")||b.c}),Object(m.jsx)(r.k,{onCommitChanges:function(){}}),Object(m.jsx)(f,{}),Object(m.jsx)(i.g,{}),Object(m.jsx)(i.d,{}),Object(m.jsx)(i.f,{}),Object(m.jsx)(i.c,{appointmentComponent:T,containerComponent:Re}),Object(m.jsx)(i.b,{showCloseButton:!0,contentComponent:D}),Object(m.jsx)(qe,{})]})})}}}]);
//# sourceMappingURL=27.828fe17e.chunk.js.map