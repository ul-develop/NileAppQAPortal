(this["webpackJsonpnile-portal"]=this["webpackJsonpnile-portal"]||[]).push([[34],{1090:function(e,t,n){"use strict";n.r(t);var a,c=n(629),r=n(919),i=n(819),s=n(11),o=n.n(s),l=n(43),j=n.n(l),b=n(50),u=n(154),d=n(0),O=n(851),p=n(652),m=n(2),f=function(){var e=Object(b.c)();return Object(m.jsxs)(O.f,{name:"IntegratedDates",children:[Object(m.jsx)(O.e,{name:"startViewDate",computed:function(t){var n=t.startViewDate;return e(Object(p.m)(n)),n}}),Object(m.jsx)(O.e,{name:"endViewDate",computed:function(t){var n=t.endViewDate;return e(Object(p.i)(n)),n}})]})},x=n(516),h=n(506),g=n(1082),v=n(1083),y=n(1084),C=n(1085),D=n(598),w=n(291),k=Object(h.a)((function(e){return{wrapper:{padding:e.spacing(2),paddingTop:0},section:{marginBottom:e.spacing(1)}}})),I=function(e){var t=e.appointmentData,n=k(),a=Object(w.o)(t),r=a.fullName,i=a.email,s=a.dre,o=Object(w.n)(t),l=o.displayDate,j=o.displayTime;return Object(m.jsxs)(c.a,{className:n.wrapper,children:[Object(m.jsx)(x.a,{variant:"h4",color:"primary",className:n.section,children:r}),Object(m.jsxs)(D.a,{sx:{mb:1,display:"flex",alignItems:"center"},children:[Object(m.jsx)(D.a,{sx:{mr:.5,display:"flex"},children:Object(m.jsx)(g.a,{fontSize:"small"})}),Object(m.jsx)(x.a,{variant:"h6",children:i})]}),s&&Object(m.jsxs)(D.a,{sx:{mb:1,display:"flex",alignItems:"center"},children:[Object(m.jsx)(D.a,{sx:{mr:.5,display:"flex"},children:Object(m.jsx)(v.a,{fontSize:"small"})}),Object(m.jsx)(x.a,{variant:"h6",children:s})]}),Object(m.jsxs)(D.a,{sx:{mb:1,display:"flex",alignItems:"center"},children:[Object(m.jsx)(D.a,{sx:{mr:.5,display:"flex"},children:Object(m.jsx)(y.a,{fontSize:"small"})}),Object(m.jsx)(x.a,{variant:"h6",children:l})]}),Object(m.jsxs)(D.a,{sx:{mb:1,display:"flex",alignItems:"center"},children:[Object(m.jsx)(D.a,{sx:{mr:.5,display:"flex"},children:Object(m.jsx)(C.a,{fontSize:"small"})}),Object(m.jsx)(x.a,{variant:"h6",children:j})]})]})},S=n(6),L=n(15),M=n(18),T=Object(h.a)((function(e){return{appointment:{zIndex:e.zIndex.speedDial,color:e.palette.background.paper,padding:e.spacing(.5,1),backgroundColor:e.palette.primary.main,"&:hover":{backgroundColor:e.palette.primary.main}},busy:{backgroundColor:"#9e9e9e","&:hover":{backgroundColor:"#9e9e9e"}},title:{color:e.palette.background.paper,overflow:"hidden",fontWeight:"bold",whiteSpace:"nowrap",textOverflow:"ellipsis"},time:{color:e.palette.background.paper}}})),A=function(e){var t=Object.assign({},e),n=t.data,a=n.title,c=T(),r=Object(w.t)(n),s=Object(w.n)(n).displayTime;return Object(m.jsx)(i.c.Appointment,Object(S.a)(Object(S.a)({},t),{},{className:Object(M.a)(c.appointment,Object(L.a)({},c.busy,r)),children:Object(m.jsxs)("div",{children:[Object(m.jsx)(x.a,{variant:"h6",classes:{root:c.title},children:a}),Object(m.jsx)(x.a,{variant:"h6",classes:{root:c.time},children:s})]})}))},E=n(153),N=["startDate","onDoubleClick"],z=Object(h.a)((function(e){return{cell:{zIndex:e.zIndex.mobileStepper},disableCell:{background:"linear-gradient(-45deg,".concat(e.palette.action.disabledBackground," 10%,transparent 10%,transparent 50%,").concat(e.palette.action.disabledBackground," 50%,").concat(e.palette.action.disabledBackground," 60%,transparent 60%,transparent)"),backgroundSize:"8px 8px",pointerEvents:"none"}}})),B=function(e){var t=z(),n=Object(b.d)((function(e){return o()(e,["calendar","config"])})),a=e.startDate,c=e.onDoubleClick,r=Object(E.a)(e,N),s=Object(b.c)();return Object(m.jsx)(i.h.TimeTableCell,Object(S.a)(Object(S.a)({},r),{},{startDate:a,id:(null===a||void 0===a?void 0:a.toString())||"",onMouseDown:function(e){e.preventDefault(),s(Object(p.c)(a))},onMouseEnter:function(e){e.preventDefault(),s(Object(p.b)(a))},onMouseUp:function(e){e.preventDefault(),c&&c(e)},className:Object(M.a)(t.cell,Object(L.a)({},t.disableCell,!Object(w.u)({dateString:a,config:n})),w.a)}))},P=Object(d.memo)(B),Y=n(30),H=n(893),V=n(40),F=n.n(V),W=Object(h.a)((function(e){return{cells:{width:"100%",position:"absolute",left:0,background:e.palette.primary.light}}})),U=function(e){var t=W(),n=e.selectingCells,a=e.slotLengthMinutes,c=Object(w.p)(n,a),r=function(e){if(e.preventDefault(),!j()(n)){var t=e.target;if(!t.classList.contains(w.a)&&!Object(w.v)(w.d,t)&&!Object(w.v)(w.c,t)){var a=n.startCell,c=document.getElementById(a.toString());c&&c.dispatchEvent(new Event("mouseup",{bubbles:!0}))}}};return d.useEffect((function(){return window.addEventListener("mouseup",r),function(){window.removeEventListener("mouseup",r)}}),[]),Object(m.jsx)("div",{className:t.cells,style:c})},Z=Object(H.a)({selectingCells:function(e){return o()(e,"calendar.selectingCells")},slotLengthMinutes:function(e){return o()(e,"calendar.config.times.slotLengthMinutes")}}),_=Object(b.b)(Z)(d.memo(U)),q=Object(h.a)((function(e){return{cell:{"&&":{padding:e.spacing(1,0),width:"100%",display:"block",textAlign:"center"}},today:{backgroundColor:Object(Y.a)(e.palette.primary.main,.16)}}})),J=function(e){var t=q(),n=e.today,a=e.startDate,c=e.selectingDate,r=e.isSelecting&&c===F()(a).format(w.b);return Object(m.jsxs)(D.a,{component:"td",sx:{display:"table-cell",position:"relative",width:"100%"},children:[Object(m.jsx)(i.h.DayScaleCell,Object(S.a)(Object(S.a)({},e),{},{className:Object(M.a)(t.cell,Object(L.a)({},t.today,n))})),r&&Object(m.jsx)(_,{})]})},R=Object(H.a)({selectingDate:function(e){return o()(e,"calendar.selectingCells.date")},isSelecting:function(e){return o()(e,"calendar.isSelecting")}}),K=Object(b.b)(R)(d.memo(J)),X=n(20),G=n(52),Q=n.n(G),$=n(91),ee=n(518),te=n(637),ne=n(640),ae=n(26),ce=n(107),re=(n(312),"SIMPLE"),ie="CHECKBOX",se="MULTI_DROPDOWN",oe="MM/DD/YYYY",le=(a={},Object(L.a)(a,re,""),Object(L.a)(a,ie,!1),Object(L.a)(a,se,""),a),je="daily",be="weekly",ue=function(e){var t=e.property,n=e.selectingCells,a=e.config,c=a.questions,r=a.times.slotLengthMinutes,i=Object(w.m)(n,r).start.format(oe),s=o()(t,"PropertyData.FullAddress",""),l=o()(ce.a,["user","attributes","email"],"");return Object(S.a)(Object(S.a)({},function(e){return e.reduce((function(e,t){var n=t.code,a=t.type;return Object(S.a)(Object(S.a)({},e),{},Object(L.a)({},n,le[a]))}),{appointmentType:void 0})}(c)),{},{FNAME:s,EMAIL:l,repeat:!1,repeatType:je,startDate:i,endDate:i})},de=function(e,t){return e.map((function(e){var n=e.code;return{code:n,string:t[n]}})).filter((function(e){return e.string}))},Oe=function(e){var t=e.selectingCells,n=e.values,a=e.config,c=a.questions,r=a.times.slotLengthMinutes,i=n.repeat,s=n.repeatType,l=n.startDate,j=n.endDate,b=function(e){return e.find((function(e){return o()(e,"name","").toLowerCase()===u.b}))}(o()(a,"services.items",[])),d=function(e,t){var n=e.startCell,a=e.endCell,c=Object(w.m)(e,t).start,r=Object(w.w)(n),i=Object(w.w)(a),s=Math.abs((r-i)/t)+1;return Array.from(Array(s),(function(e,n){return{startsAt:F()(c).add(n*t,"m").format("YYYY-MM-DDTHH:mm:ss")}}))}(t,r);if(!i)return d.map((function(e){return{startsAt:e.startsAt,title:u.b,tentative:"NOT_USED",timeZone:F.a.tz.guess(),cancelled:!1,units:1,services:[b],answers:de(c,n)}}));var O=F()(l),p=F()(j).diff(O,"day"),m=s===be?7:1;return Array.from(Array(Math.floor(p/m)+1),(function(e,t){return t*m})).reduce((function(e,t){var a=F()(l).add(t,"day"),r=d.map((function(e){var t=e.startsAt;return{title:u.b,startsAt:"".concat(a.format("YYYY-MM-DD"),"T").concat(F()(t).format("HH:mm:ss")),tentative:"NOT_USED",timeZone:F.a.tz.guess(),cancelled:!1,units:1,services:[b],answers:de(c,n)}}));return[].concat(Object(ae.a)(e),Object(ae.a)(r))}),[])},pe=function(e){var t=e.map((function(e){return o()(e,"startsAt")})).join(", ");return{message:"Cannot book at dates: ".concat(t)}},me=Object(h.a)((function(e){return{wrapper:Object(S.a)(Object(S.a)({},e.typography.h4),{},{padding:e.spacing(2,0),backgroundColor:e.palette.grey[100],textAlign:"center"})}})),fe=function(e){var t=e.selectingCells,n=e.slotLengthMinutes,a=me();if(j()(t))return Object(m.jsx)("div",{});var c=t.date,r=Object(w.m)(t,n),i=r.start,s=r.end,o=Object(w.l)(i),l=Object(w.l)(s);return Object(m.jsxs)("div",{className:a.wrapper,children:[Object(m.jsx)(x.a,{variant:"h4",children:Object(w.j)(c)}),Object(m.jsx)(D.a,{sx:{mt:1},children:Object(m.jsxs)(x.a,{variant:"h3",children:[o," - ",l]})})]})},xe=Object(H.a)({selectingCells:function(e){return o()(e,"calendar.selectingCells")},slotLengthMinutes:function(e){return o()(e,"calendar.config.times.slotLengthMinutes")}}),he=Object(b.b)(xe)(Object(d.memo)(fe)),ge=n(686),ve=n(1040),ye=n(767),Ce=n(1112),De=n(628),we=n(891),ke=n(889),Ie=n(624),Se=n(716),Le=n(1086),Me=n(1087),Te=["helperText"],Ae=["helperText"],Ee=function(){var e=Object(ne.d)(),t=e.values,n=e.handleChange,a=e.setFieldValue,c=function(e){return function(t){a(e,F()(t).format(oe))}},r=o()(t,"repeat"),i=o()(t,"repeatType"),s=o()(t,"startDate"),l=o()(t,"endDate");return Object(m.jsxs)("div",{children:[Object(m.jsx)(ye.a,{control:Object(m.jsx)(Ce.a,{name:"repeat",checked:r,onChange:n,color:"primary"}),label:"Repeat"}),Object(m.jsxs)(De.a,{in:r,children:[Object(m.jsx)("div",{children:Object(m.jsxs)(we.a,{name:"repeatType",value:i,onChange:n,children:[Object(m.jsx)(ye.a,{value:"daily",control:Object(m.jsx)(ke.a,{color:"primary"}),label:"Daily"}),Object(m.jsx)(ye.a,{value:"weekly",control:Object(m.jsx)(ke.a,{color:"primary"}),label:"Weekly"})]})}),Object(m.jsx)(D.a,{sx:{mt:2,mb:1},children:Object(m.jsx)(Le.b,{dateAdapter:ve.a,children:Object(m.jsxs)(Ie.a,{container:!0,justifyContent:"space-between",children:[Object(m.jsx)(Ie.a,{item:!0,xs:5,children:Object(m.jsx)(Me.a,{label:"Start date",inputFormat:oe,value:new Date(s),onChange:c("startDate"),renderInput:function(e){e.helperText;var t=Object(E.a)(e,Te);return Object(m.jsx)(Se.a,Object(S.a)({},t))},PopperProps:{id:w.c}})}),Object(m.jsx)(Ie.a,{item:!0,xs:5,children:Object(m.jsx)(Me.a,{label:"End date",inputFormat:oe,value:new Date(l),onChange:c("endDate"),renderInput:function(e){e.helperText;var t=Object(E.a)(e,Ae);return Object(m.jsx)(Se.a,Object(S.a)({},t))},PopperProps:{id:w.c}})})]})})})]})]})},Ne=function(e){var t=e.onSave,n=Object(b.c)(),a=Object(b.d)((function(e){return o()(e,["calendar","property"])})),c=o()(a,"HomeViewingCalendarProfileId"),r=Object(b.d)((function(e){return o()(e,["calendar","config"])})),i=Object(b.d)((function(e){return o()(e,["calendar","isLoading"])})),s=Object(b.d)((function(e){return o()(e,["calendar","selectingCells"])}));if(j()(s))return Object(m.jsx)(D.a,{});var l=ue({property:a,selectingCells:s,config:r}),u=function(){var e=Object($.a)(Q.a.mark((function e(a){var i,o,l,b;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(Object(p.k)(!0)),e.prev=1,i=Oe({selectingCells:s,values:a,config:r}),e.next=5,ge.a.createBookings({profileId:c,data:i});case 5:o=e.sent,l=o.bookings,b=o.errors,j()(b)||n(Object(p.j)(pe(b))),n(Object(p.a)(l)),t(),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),n(Object(p.j)(e.t0));case 16:n(Object(p.k)(!1));case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsx)(D.a,{sx:{display:"flex",flexDirection:"column"},children:Object(m.jsx)(ne.b,{initialValues:l,onSubmit:u,children:Object(m.jsxs)(ne.a,{children:[Object(m.jsx)(D.a,{sx:{mb:2},children:Object(m.jsx)(x.a,{variant:"h4",children:"Block available slots"})}),Object(m.jsx)(he,{}),Object(m.jsx)(ee.a,{}),Object(m.jsx)(D.a,{sx:{my:2},children:Object(m.jsx)(Ee,{})}),Object(m.jsx)(te.a,{type:"submit",color:"primary",disableElevation:!0,fullWidth:!0,variant:"contained",disabled:i,children:"Confirm Booking"})]})})})},ze=function(e){var t=e.onSave;return Object(m.jsx)(Ne,{onSave:t})},Be=n(621),Pe=n(626),Ye=n(600),He=["children","visible","onHide"],Ve=Object(h.a)((function(e){return{root:{display:"flex",alignItems:"center",justifyContent:"center"},content:{zIndex:e.zIndex.appBar}}})),Fe=function(e){var t=e.children,n=e.visible,a=e.onHide,c=Object(E.a)(e,He),r=Ve(),i=Object(b.c)();return Object(m.jsx)(Be.a,Object(S.a)(Object(S.a)({id:w.d,className:r.root,onClose:function(){a(),i(Object(p.n)())},closeAfterTransition:!0,BackdropComponent:Pe.a,BackdropProps:{timeout:500},open:n},c),{},{children:Object(m.jsx)(Ye.a,{in:n,children:Object(m.jsx)("div",{className:r.content,children:t})})}))},We=["basicLayoutComponent","commandLayoutComponent","recurrenceLayoutComponent","children"],Ue=Object(h.a)((function(e){return{layout:{background:e.palette.common.white},content:{padding:e.spacing(4),width:"30vw",minWidth:"300px",overflow:"auto",maxHeight:"90vh"}}})),Ze=function(e){var t=e.basicLayoutComponent,n=e.commandLayoutComponent,a=e.recurrenceLayoutComponent,c=e.children,r=Object(E.a)(e,We),i=Ue();return Object(m.jsxs)("div",Object(S.a)(Object(S.a)({className:i.layout},r),{},{children:[Object(m.jsx)(n,{}),Object(m.jsxs)("div",{className:i.content,children:[Object(m.jsx)(t,{}),Object(m.jsx)(a,{})]}),c]}))},_e=function(e){var t=e.onCommitButtonClick,n=e.isSaving,a=e.setIsSaving;return Object(d.useEffect)((function(){n&&(t(),a(!1))}),[n]),Object(m.jsx)("div",{})},qe=function(){var e=Object(d.useState)(!1),t=Object(X.a)(e,2),n=t[0],a=t[1],c=Object(b.c)(),r=function(){a(!0),c(Object(p.n)())},s=Object(O.k)(ze,(function(){return{onSave:r}})),o=Object(O.k)(_e,(function(){return{isSaving:n,setIsSaving:a}}));return Object(m.jsx)(i.a,{layoutComponent:Ze,basicLayoutComponent:s,commandLayoutComponent:o,overlayComponent:Fe})},Je=["style","children"],Re=function(e){var t=e.style,n=e.children,a=Object(E.a)(e,Je);return Object(m.jsx)("div",Object(S.a)(Object(S.a)({style:Object(S.a)(Object(S.a)({},t),{},{zIndex:1200})},a),{},{children:n}))},Ke=n(823),Xe=n(753),Ge=n(1041),Qe=n.n(Ge),$e=function(){var e=F.a.tz.names(),t=Object(d.useState)(""),n=Object(X.a)(t,2),a=n[0],c=n[1],r=Object(b.c)(),i=Object(b.d)((function(e){return o()(e,["calendar","clientTimeZone"])}));return Object(m.jsx)(D.a,{bgcolor:"grey.100",sx:{p:2},alignItems:"center",display:"flex",children:Object(m.jsx)(D.a,{sx:{width:{xs:"100%",lg:"30%"}},children:Object(m.jsx)(Ke.a,{options:e,value:i,onChange:function(e,t){t&&r(Object(p.g)(t))},getOptionLabel:function(e){return e},inputValue:a,onInputChange:function(e,t){c(t)},renderInput:function(e){return Object(m.jsx)(Se.a,Object(S.a)(Object(S.a)({},e),{},{variant:"outlined",InputProps:Object(S.a)(Object(S.a)({},e.InputProps),{},{startAdornment:Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(Xe.a,{position:"start",children:Object(m.jsx)(Qe.a,{})}),e.InputProps.startAdornment]})})}))}})})})},et=Object(d.memo)($e);t.default=function(e){if(!e.profileId)return null;var t=Object(b.d)((function(e){return o()(e,["calendar","config"])})),n=Object(b.d)((function(e){return o()(e,["calendar","appointments"])}));return j()(t)?Object(m.jsx)(m.Fragment,{}):Object(m.jsxs)(c.a,{elevation:3,children:[Object(m.jsx)(et,{}),Object(m.jsxs)(i.e,{data:n,children:[Object(m.jsx)(r.r,{}),Object(m.jsx)(i.h,{timeTableCellComponent:P,dayScaleCellComponent:K,cellDuration:o()(t,"slotLengthMinutes")||u.c}),Object(m.jsx)(r.k,{onCommitChanges:function(){}}),Object(m.jsx)(f,{}),Object(m.jsx)(i.g,{}),Object(m.jsx)(i.d,{}),Object(m.jsx)(i.f,{}),Object(m.jsx)(i.c,{appointmentComponent:A,containerComponent:Re}),Object(m.jsx)(i.b,{showCloseButton:!0,contentComponent:I}),Object(m.jsx)(qe,{})]})]})}}}]);
//# sourceMappingURL=34.19d9d255.chunk.js.map