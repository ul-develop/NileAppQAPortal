(this["webpackJsonpnile-portal"]=this["webpackJsonpnile-portal"]||[]).push([[27],{1132:function(e,t,n){"use strict";n.r(t);var a,c=n(714),r=n(902),i=n(789),s=n(25),o=n.n(s),l=n(107),j=n.n(l),b=n(51),u=n(164),d=n(0),O=n(809),p=n(746),m=n(2),f=function(){var e=Object(b.c)();return Object(m.jsxs)(O.f,{name:"IntegratedDates",children:[Object(m.jsx)(O.e,{name:"startViewDate",computed:function(t){var n=t.startViewDate;return e(Object(p.l)(n)),n}}),Object(m.jsx)(O.e,{name:"endViewDate",computed:function(t){var n=t.endViewDate;return e(Object(p.h)(n)),n}})]})},x=n(601),h=n(591),v=n(1124),g=n(1125),y=n(1126),C=n(1127),D=n(683),w=n(303),k=Object(h.a)((function(e){return{wrapper:{padding:e.spacing(2),paddingTop:0},section:{marginBottom:e.spacing(1)}}})),S=function(e){var t=e.appointmentData,n=k(),a=Object(w.o)(t),r=a.fullName,i=a.email,s=a.dre,o=Object(w.n)(t),l=o.displayDate,j=o.displayTime;return Object(m.jsxs)(c.a,{className:n.wrapper,children:[Object(m.jsx)(x.a,{variant:"h4",color:"primary",className:n.section,children:r}),Object(m.jsxs)(D.a,{sx:{mb:1,display:"flex",alignItems:"center"},children:[Object(m.jsx)(D.a,{sx:{mr:.5,display:"flex"},children:Object(m.jsx)(v.a,{fontSize:"small"})}),Object(m.jsx)(x.a,{variant:"h6",children:i})]}),s&&Object(m.jsxs)(D.a,{sx:{mb:1,display:"flex",alignItems:"center"},children:[Object(m.jsx)(D.a,{sx:{mr:.5,display:"flex"},children:Object(m.jsx)(g.a,{fontSize:"small"})}),Object(m.jsx)(x.a,{variant:"h6",children:s})]}),Object(m.jsxs)(D.a,{sx:{mb:1,display:"flex",alignItems:"center"},children:[Object(m.jsx)(D.a,{sx:{mr:.5,display:"flex"},children:Object(m.jsx)(y.a,{fontSize:"small"})}),Object(m.jsx)(x.a,{variant:"h6",children:l})]}),Object(m.jsxs)(D.a,{sx:{mb:1,display:"flex",alignItems:"center"},children:[Object(m.jsx)(D.a,{sx:{mr:.5,display:"flex"},children:Object(m.jsx)(C.a,{fontSize:"small"})}),Object(m.jsx)(x.a,{variant:"h6",children:j})]})]})},L=n(9),I=n(14),M=n(17),T=Object(h.a)((function(e){return{appointment:{zIndex:e.zIndex.speedDial,color:e.palette.background.paper,padding:e.spacing(.5,1),backgroundColor:e.palette.primary.main,"&:hover":{backgroundColor:e.palette.primary.main}},busy:{backgroundColor:"#9e9e9e","&:hover":{backgroundColor:"#9e9e9e"}},title:{color:e.palette.background.paper,overflow:"hidden",fontWeight:"bold",whiteSpace:"nowrap",textOverflow:"ellipsis"},time:{color:e.palette.background.paper}}})),A=function(e){var t=Object.assign({},e),n=t.data,a=n.title,c=T(),r=Object(w.t)(n),s=Object(w.n)(n).displayTime;return Object(m.jsx)(i.c.Appointment,Object(L.a)(Object(L.a)({},t),{},{className:Object(M.a)(c.appointment,Object(I.a)({},c.busy,r)),children:Object(m.jsxs)("div",{children:[Object(m.jsx)(x.a,{variant:"h6",classes:{root:c.title},children:a}),Object(m.jsx)(x.a,{variant:"h6",classes:{root:c.time},children:s})]})}))},E=n(134),N=["startDate","onDoubleClick"],z=Object(h.a)((function(e){return{cell:{zIndex:e.zIndex.mobileStepper},disableCell:{background:"linear-gradient(-45deg,".concat(e.palette.action.disabledBackground," 10%,transparent 10%,transparent 50%,").concat(e.palette.action.disabledBackground," 50%,").concat(e.palette.action.disabledBackground," 60%,transparent 60%,transparent)"),backgroundSize:"8px 8px",pointerEvents:"none"}}})),B=function(e){var t=z(),n=Object(b.d)((function(e){return o()(e,["calendar","config"])})),a=e.startDate,c=e.onDoubleClick,r=Object(E.a)(e,N),s=Object(b.c)();return Object(m.jsx)(i.h.TimeTableCell,Object(L.a)(Object(L.a)({},r),{},{startDate:a,id:(null===a||void 0===a?void 0:a.toString())||"",onMouseDown:function(e){e.preventDefault(),s(Object(p.c)(a))},onMouseEnter:function(e){e.preventDefault(),s(Object(p.b)(a))},onMouseUp:function(e){e.preventDefault(),c&&c(e)},className:Object(M.a)(t.cell,Object(I.a)({},t.disableCell,!Object(w.u)({dateString:a,config:n})),w.a)}))},Y=Object(d.memo)(B),H=n(27),P=n(861),V=n(48),F=n.n(V),W=Object(h.a)((function(e){return{cells:{width:"100%",position:"absolute",left:0,background:e.palette.primary.light}}})),U=function(e){var t=W(),n=e.selectingCells,a=e.slotLengthMinutes,c=Object(w.p)(n,a),r=function(e){if(e.preventDefault(),!j()(n)){var t=e.target;if(!t.classList.contains(w.a)&&!Object(w.v)(w.d,t)&&!Object(w.v)(w.c,t)){var a=n.startCell,c=document.getElementById(a.toString());c&&c.dispatchEvent(new Event("mouseup",{bubbles:!0}))}}};return d.useEffect((function(){return window.addEventListener("mouseup",r),function(){window.removeEventListener("mouseup",r)}}),[]),Object(m.jsx)("div",{className:t.cells,style:c})},_=Object(P.a)({selectingCells:function(e){return o()(e,"calendar.selectingCells")},slotLengthMinutes:function(e){return o()(e,"calendar.config.times.slotLengthMinutes")}}),q=Object(b.b)(_)(d.memo(U)),J=Object(h.a)((function(e){return{cell:{"&&":{padding:e.spacing(1,0),width:"100%",display:"block",textAlign:"center"}},today:{backgroundColor:Object(H.a)(e.palette.primary.main,.16)}}})),R=function(e){var t=J(),n=e.today,a=e.startDate,c=e.selectingDate,r=e.isSelecting&&c===F()(a).format(w.b);return Object(m.jsxs)(D.a,{component:"td",sx:{display:"table-cell",position:"relative",width:"100%"},children:[Object(m.jsx)(i.h.DayScaleCell,Object(L.a)(Object(L.a)({},e),{},{className:Object(M.a)(t.cell,Object(I.a)({},t.today,n))})),r&&Object(m.jsx)(q,{})]})},Z=Object(P.a)({selectingDate:function(e){return o()(e,"calendar.selectingCells.date")},isSelecting:function(e){return o()(e,"calendar.isSelecting")}}),K=Object(b.b)(Z)(d.memo(R)),X=n(20),G=n(52),Q=n.n(G),$=n(95),ee=n(604),te=n(723),ne=n(734),ae=n(28),ce=n(116),re=(n(416),"SIMPLE"),ie="CHECKBOX",se="MULTI_DROPDOWN",oe="MM/DD/YYYY",le=(a={},Object(I.a)(a,re,""),Object(I.a)(a,ie,!1),Object(I.a)(a,se,""),a),je="daily",be="weekly",ue=function(e){var t=e.property,n=e.selectingCells,a=e.config,c=a.questions,r=a.times.slotLengthMinutes,i=Object(w.m)(n,r).start.format(oe),s=o()(t,"PropertyData.FullAddress",""),l=o()(ce.a,["user","attributes","email"],"");return Object(L.a)(Object(L.a)({},function(e){return e.reduce((function(e,t){var n=t.code,a=t.type;return Object(L.a)(Object(L.a)({},e),{},Object(I.a)({},n,le[a]))}),{appointmentType:void 0})}(c)),{},{FNAME:s,EMAIL:l,repeat:!1,repeatType:je,startDate:i,endDate:i})},de=function(e,t){return e.map((function(e){var n=e.code;return{code:n,string:t[n]}})).filter((function(e){return e.string}))},Oe=function(e){var t=e.selectingCells,n=e.values,a=e.config,c=a.questions,r=a.times.slotLengthMinutes,i=n.repeat,s=n.repeatType,l=n.startDate,j=n.endDate,b=function(e){return e.find((function(e){return o()(e,"name","").toLowerCase()===u.b}))}(o()(a,"services.items",[])),d=function(e,t){var n=e.startCell,a=e.endCell,c=Object(w.m)(e,t).start,r=Object(w.w)(n),i=Object(w.w)(a),s=Math.abs((r-i)/t)+1;return Array.from(Array(s),(function(e,n){return{startsAt:F()(c).add(n*t,"m").format("YYYY-MM-DDTHH:mm:ss")}}))}(t,r);if(!i)return d.map((function(e){return{startsAt:e.startsAt,title:u.b,tentative:"NOT_USED",timeZone:F.a.tz.guess(),cancelled:!1,units:1,services:[b],answers:de(c,n)}}));var O=F()(l),p=F()(j).diff(O,"day"),m=s===be?7:1;return Array.from(Array(Math.floor(p/m)+1),(function(e,t){return t*m})).reduce((function(e,t){var a=F()(l).add(t,"day"),r=d.map((function(e){var t=e.startsAt;return{title:u.b,startsAt:"".concat(a.format("YYYY-MM-DD"),"T").concat(F()(t).format("HH:mm:ss")),tentative:"NOT_USED",timeZone:F.a.tz.guess(),cancelled:!1,units:1,services:[b],answers:de(c,n)}}));return[].concat(Object(ae.a)(e),Object(ae.a)(r))}),[])},pe=function(e){var t=e.map((function(e){return o()(e,"startsAt")})).join(", ");return{message:"Cannot book at dates: ".concat(t)}},me=Object(h.a)((function(e){return{wrapper:Object(L.a)(Object(L.a)({},e.typography.h4),{},{padding:e.spacing(2,0),backgroundColor:e.palette.grey[100],textAlign:"center"})}})),fe=function(e){var t=e.selectingCells,n=e.slotLengthMinutes,a=me();if(j()(t))return Object(m.jsx)("div",{});var c=t.date,r=Object(w.m)(t,n),i=r.start,s=r.end,o=Object(w.l)(i),l=Object(w.l)(s);return Object(m.jsxs)("div",{className:a.wrapper,children:[Object(m.jsx)(x.a,{variant:"h4",children:Object(w.j)(c)}),Object(m.jsx)(D.a,{sx:{mt:1},children:Object(m.jsxs)(x.a,{variant:"h3",children:[o," - ",l]})})]})},xe=Object(P.a)({selectingCells:function(e){return o()(e,"calendar.selectingCells")},slotLengthMinutes:function(e){return o()(e,"calendar.config.times.slotLengthMinutes")}}),he=Object(b.b)(xe)(Object(d.memo)(fe)),ve=n(864),ge=n(1073),ye=n(1163),Ce=n(1168),De=n(715),we=n(1146),ke=n(1136),Se=n(709),Le=n(1154),Ie=n(1128),Me=n(1130),Te=["helperText"],Ae=["helperText"],Ee=function(){var e=Object(ne.e)(),t=e.values,n=e.handleChange,a=e.setFieldValue,c=function(e){return function(t){a(e,F()(t).format(oe))}},r=o()(t,"repeat"),i=o()(t,"repeatType"),s=o()(t,"startDate"),l=o()(t,"endDate");return Object(m.jsxs)("div",{children:[Object(m.jsx)(ye.a,{control:Object(m.jsx)(Ce.a,{name:"repeat",checked:r,onChange:n,color:"primary"}),label:"Repeat"}),Object(m.jsxs)(De.a,{in:r,children:[Object(m.jsx)("div",{children:Object(m.jsxs)(we.a,{name:"repeatType",value:i,onChange:n,children:[Object(m.jsx)(ye.a,{value:"daily",control:Object(m.jsx)(ke.a,{color:"primary"}),label:"Daily"}),Object(m.jsx)(ye.a,{value:"weekly",control:Object(m.jsx)(ke.a,{color:"primary"}),label:"Weekly"})]})}),Object(m.jsx)(D.a,{sx:{mt:2,mb:1},children:Object(m.jsx)(Ie.b,{dateAdapter:ge.a,children:Object(m.jsxs)(Se.a,{container:!0,justifyContent:"space-between",children:[Object(m.jsx)(Se.a,{item:!0,xs:5,children:Object(m.jsx)(Me.a,{label:"Start date",inputFormat:oe,value:new Date(s),onChange:c("startDate"),renderInput:function(e){e.helperText;var t=Object(E.a)(e,Te);return Object(m.jsx)(Le.a,Object(L.a)({},t))},PopperProps:{id:w.c}})}),Object(m.jsx)(Se.a,{item:!0,xs:5,children:Object(m.jsx)(Me.a,{label:"End date",inputFormat:oe,value:new Date(l),onChange:c("endDate"),renderInput:function(e){e.helperText;var t=Object(E.a)(e,Ae);return Object(m.jsx)(Le.a,Object(L.a)({},t))},PopperProps:{id:w.c}})})]})})})]})]})},Ne=function(e){var t=e.onSave,n=Object(b.c)(),a=Object(b.d)((function(e){return o()(e,["calendar","property"])})),c=o()(a,"HomeViewingCalendarProfileId"),r=Object(b.d)((function(e){return o()(e,["calendar","config"])})),i=Object(b.d)((function(e){return o()(e,["calendar","isLoading"])})),s=Object(b.d)((function(e){return o()(e,["calendar","selectingCells"])}));if(j()(s))return Object(m.jsx)(D.a,{});var l=ue({property:a,selectingCells:s,config:r}),u=function(){var e=Object($.a)(Q.a.mark((function e(a){var i,o,l,b;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(Object(p.j)(!0)),e.prev=1,i=Oe({selectingCells:s,values:a,config:r}),e.next=5,ve.a.createBookings({profileId:c,data:i});case 5:o=e.sent,l=o.bookings,b=o.errors,j()(b)||n(Object(p.i)(pe(b))),n(Object(p.a)(l)),t(),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),n(Object(p.i)(e.t0));case 16:n(Object(p.j)(!1));case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsx)(D.a,{sx:{display:"flex",flexDirection:"column"},children:Object(m.jsx)(ne.c,{initialValues:l,onSubmit:u,children:Object(m.jsxs)(ne.b,{children:[Object(m.jsx)(D.a,{sx:{mb:2},children:Object(m.jsx)(x.a,{variant:"h4",children:"Block available slots"})}),Object(m.jsx)(he,{}),Object(m.jsx)(ee.a,{}),Object(m.jsx)(D.a,{sx:{my:2},children:Object(m.jsx)(Ee,{})}),Object(m.jsx)(te.a,{type:"submit",color:"primary",disableElevation:!0,fullWidth:!0,variant:"contained",disabled:i,children:"Confirm Booking"})]})})})},ze=function(e){var t=e.onSave;return Object(m.jsx)(Ne,{onSave:t})},Be=n(707),Ye=n(712),He=n(685),Pe=["children","visible","onHide"],Ve=Object(h.a)((function(e){return{root:{display:"flex",alignItems:"center",justifyContent:"center"},content:{zIndex:e.zIndex.appBar}}})),Fe=function(e){var t=e.children,n=e.visible,a=e.onHide,c=Object(E.a)(e,Pe),r=Ve(),i=Object(b.c)();return Object(m.jsx)(Be.a,Object(L.a)(Object(L.a)({id:w.d,className:r.root,onClose:function(){a(),i(Object(p.m)())},closeAfterTransition:!0,BackdropComponent:Ye.a,BackdropProps:{timeout:500},open:n},c),{},{children:Object(m.jsx)(He.a,{in:n,children:Object(m.jsx)("div",{className:r.content,children:t})})}))},We=["basicLayoutComponent","commandLayoutComponent","recurrenceLayoutComponent","children"],Ue=Object(h.a)((function(e){return{layout:{background:e.palette.common.white},content:{padding:e.spacing(4),width:"30vw",minWidth:"300px",overflow:"auto",maxHeight:"90vh"}}})),_e=function(e){var t=e.basicLayoutComponent,n=e.commandLayoutComponent,a=e.recurrenceLayoutComponent,c=e.children,r=Object(E.a)(e,We),i=Ue();return Object(m.jsxs)("div",Object(L.a)(Object(L.a)({className:i.layout},r),{},{children:[Object(m.jsx)(n,{}),Object(m.jsxs)("div",{className:i.content,children:[Object(m.jsx)(t,{}),Object(m.jsx)(a,{})]}),c]}))},qe=function(e){var t=e.onCommitButtonClick,n=e.isSaving,a=e.setIsSaving;return Object(d.useEffect)((function(){n&&(t(),a(!1))}),[n]),Object(m.jsx)("div",{})},Je=function(){var e=Object(d.useState)(!1),t=Object(X.a)(e,2),n=t[0],a=t[1],c=Object(b.c)(),r=function(){a(!0),c(Object(p.m)())},s=Object(O.k)(ze,(function(){return{onSave:r}})),o=Object(O.k)(qe,(function(){return{isSaving:n,setIsSaving:a}}));return Object(m.jsx)(i.a,{layoutComponent:_e,basicLayoutComponent:s,commandLayoutComponent:o,overlayComponent:Fe})},Re=["style","children"],Ze=function(e){var t=e.style,n=e.children,a=Object(E.a)(e,Re);return Object(m.jsx)("div",Object(L.a)(Object(L.a)({style:Object(L.a)(Object(L.a)({},t),{},{zIndex:1200})},a),{},{children:n}))};t.default=function(e){if(!e.profileId)return null;var t=Object(b.d)((function(e){return o()(e,["calendar","config"])})),n=Object(b.d)((function(e){return o()(e,["calendar","appointments"])}));return j()(t)?Object(m.jsx)(m.Fragment,{}):Object(m.jsx)(c.a,{elevation:3,children:Object(m.jsxs)(i.e,{data:n,children:[Object(m.jsx)(r.r,{}),Object(m.jsx)(i.h,{timeTableCellComponent:Y,dayScaleCellComponent:K,cellDuration:o()(t,"slotLengthMinutes")||u.c}),Object(m.jsx)(r.k,{onCommitChanges:function(){}}),Object(m.jsx)(f,{}),Object(m.jsx)(i.g,{}),Object(m.jsx)(i.d,{}),Object(m.jsx)(i.f,{}),Object(m.jsx)(i.c,{appointmentComponent:A,containerComponent:Ze}),Object(m.jsx)(i.b,{showCloseButton:!0,contentComponent:S}),Object(m.jsx)(Je,{})]})})}}}]);
//# sourceMappingURL=27.55f84b16.chunk.js.map